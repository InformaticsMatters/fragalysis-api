\hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand}{}\section{fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand Class Reference}
\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand}\index{fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand@{fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand}}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a93d37150b50131f70bb890e6ec609047}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a93d37150b50131f70bb890e6ec609047}} 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, target\+\_\+name, infile, R\+E\+S\+U\+L\+T\+S\+\_\+\+D\+I\+R\+E\+C\+T\+O\+RY)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_af0d3d0b75f9f10f0f50cba06017c4ba6}{hets\+\_\+and\+\_\+cons} (self)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_af21865a4bb9be6aab21bfc82668ba25e}{remove\+\_\+nonligands} (self)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_aa9601289368daa83655aa849041e7b63}{find\+\_\+ligand\+\_\+names\+\_\+new} (self)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a1f1e4e6058646f97f6fba517f187b64c}{create\+\_\+pdb\+\_\+for\+\_\+ligand} (self, ligand, count, monomerize)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a811498c568a5f12e8047ced3640a3c90}{create\+\_\+mol\+\_\+file} (self, directory, file\+\_\+base, mol\+\_\+obj, smiles\+\_\+file=None)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a9985de5dae739f11768aa6985ccd94bd}{create\+\_\+sd\+\_\+file} (self, mol\+\_\+obj, writer)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a58df3b55a6aca35511598a8d0e25ed6d}{create\+\_\+metadata\+\_\+file} (self, directory, file\+\_\+base, mol\+\_\+obj, smiles\+\_\+file=None)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a32128e8047085e698f5ca00f3c5272a9}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a32128e8047085e698f5ca00f3c5272a9}} 
{\bfseries infile}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a7bacd3ad4cf07e41aed7a9f2a4ff387a}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a7bacd3ad4cf07e41aed7a9f2a4ff387a}} 
{\bfseries target\+\_\+name}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ac4eb80e71c44f6b864a952f225cd8004}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ac4eb80e71c44f6b864a952f225cd8004}} 
{\bfseries mol\+\_\+lst}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a19412f84749bbb24a26587412126c63d}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a19412f84749bbb24a26587412126c63d}} 
{\bfseries mol\+\_\+dict}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_aae0e03b03bc78f6d2df7f84a6df36901}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_aae0e03b03bc78f6d2df7f84a6df36901}} 
{\bfseries R\+E\+S\+U\+L\+T\+S\+\_\+\+D\+I\+R\+E\+C\+T\+O\+RY}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a9f563bbab62fe3a11a8922c820b94e42}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a9f563bbab62fe3a11a8922c820b94e42}} 
{\bfseries non\+\_\+ligs}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ae69abc7403000638fc3a713f52254154}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ae69abc7403000638fc3a713f52254154}} 
{\bfseries pdbfile}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a9ca075a4d8a93d03faf8a68d2ca8cb22}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a9ca075a4d8a93d03faf8a68d2ca8cb22}} 
{\bfseries hetatms}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ae95cb0d8d1e5783aa0959ce6fe03256b}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ae95cb0d8d1e5783aa0959ce6fe03256b}} 
{\bfseries conects}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ad7639b1a8c8c767a298eb7454bf5e3fd}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ad7639b1a8c8c767a298eb7454bf5e3fd}} 
{\bfseries final\+\_\+hets}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ae4f4ee5bf6c21bd59c1e52da2b4f67b5}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_ae4f4ee5bf6c21bd59c1e52da2b4f67b5}} 
{\bfseries wanted\+\_\+ligs}
\item 
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_af2f58c632ceb036a9502c33f2681aba9}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_af2f58c632ceb036a9502c33f2681aba9}} 
{\bfseries new\+\_\+lig\+\_\+name}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 12 of file conversion\+\_\+pdb\+\_\+mol.\+py.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a58df3b55a6aca35511598a8d0e25ed6d}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a58df3b55a6aca35511598a8d0e25ed6d}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}!create\+\_\+metadata\+\_\+file@{create\+\_\+metadata\+\_\+file}}
\index{create\+\_\+metadata\+\_\+file@{create\+\_\+metadata\+\_\+file}!fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}}
\subsubsection{\texorpdfstring{create\+\_\+metadata\+\_\+file()}{create\_metadata\_file()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand.\+create\+\_\+metadata\+\_\+file (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{directory,  }\item[{}]{file\+\_\+base,  }\item[{}]{mol\+\_\+obj,  }\item[{}]{smiles\+\_\+file = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Metadata .csv file prepared for each ligand
params: file_base and smiles
returns: .mol file for the ligand
\end{DoxyVerb}
 

Definition at line 251 of file conversion\+\_\+pdb\+\_\+mol.\+py.


\begin{DoxyCode}
251     \textcolor{keyword}{def }create\_metadata\_file(self, directory, file\_base, mol\_obj, smiles\_file=None):
252         \textcolor{stringliteral}{"""}
253 \textcolor{stringliteral}{        Metadata .csv file prepared for each ligand}
254 \textcolor{stringliteral}{        params: file\_base and smiles}
255 \textcolor{stringliteral}{        returns: .mol file for the ligand}
256 \textcolor{stringliteral}{        """}
257 
258         meta\_out\_file = os.path.join(directory, str(file\_base + \textcolor{stringliteral}{"\_meta.csv"}))
259         smiles\_out\_file = os.path.join(directory, str(file\_base + \textcolor{stringliteral}{"\_smiles.txt"}))
260 
261         \textcolor{keywordflow}{if} smiles\_file:
262             \textcolor{keywordflow}{try}:
263                 smiles = open(smiles\_file, \textcolor{stringliteral}{'r').readlines()[0].rstrip()}
264 \textcolor{stringliteral}{                }\textcolor{comment}{# write to .txt file}
265                 smiles\_txt = open(smiles\_out\_file, \textcolor{stringliteral}{"w+"})
266                 smiles\_txt.write(smiles)
267                 smiles\_txt.close()
268 
269             \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} e:
270                 print(e)
271                 print(\textcolor{stringliteral}{'failed to open smiles file '} + smiles\_file)
272 
273         \textcolor{keywordflow}{else}:
274             print(f\textcolor{stringliteral}{'Warning: No smiles file: \{file\_base\}'})
275             \textcolor{comment}{# Try use mol\_obj if no smiles file}
276             \textcolor{keywordflow}{try}:
277                 smiles = Chem.MolToSmiles(mol\_obj)
278             \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} e:
279                 print(e)
280                 print(\textcolor{stringliteral}{'failed to convert mol obj to smiles'} + smiles\_file)
281 
282                 smiles = \textcolor{stringliteral}{"NA"}
283 
284         meta\_data\_dict = \{\textcolor{stringliteral}{'Blank'}:\textcolor{stringliteral}{''},
285                           \textcolor{stringliteral}{'fragalysis\_name'}: file\_base,
286                           \textcolor{stringliteral}{'crystal\_name'}: file\_base.rsplit(\textcolor{stringliteral}{'\_'}, 1)[0],
287                           \textcolor{stringliteral}{'smiles'}: smiles,
288                           \textcolor{stringliteral}{'new\_smiles'}:\textcolor{stringliteral}{''},
289                           \textcolor{stringliteral}{'alternate\_name'}:\textcolor{stringliteral}{''},
290                           \textcolor{stringliteral}{'site\_name'}:\textcolor{stringliteral}{''},
291                           \textcolor{stringliteral}{'pdb\_entry'}:\textcolor{stringliteral}{''}\}
292 
293         \textcolor{comment}{# Write dict to csv}
294         meta\_data\_file = open(meta\_out\_file, \textcolor{stringliteral}{'w+'})
295         w = csv.DictWriter(meta\_data\_file, meta\_data\_dict.keys())
296         w.writerow(meta\_data\_dict)
297         meta\_data\_file.close()
298 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a811498c568a5f12e8047ced3640a3c90}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a811498c568a5f12e8047ced3640a3c90}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}!create\+\_\+mol\+\_\+file@{create\+\_\+mol\+\_\+file}}
\index{create\+\_\+mol\+\_\+file@{create\+\_\+mol\+\_\+file}!fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}}
\subsubsection{\texorpdfstring{create\+\_\+mol\+\_\+file()}{create\_mol\_file()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand.\+create\+\_\+mol\+\_\+file (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{directory,  }\item[{}]{file\+\_\+base,  }\item[{}]{mol\+\_\+obj,  }\item[{}]{smiles\+\_\+file = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}a .mol file is produced for an individual ligand

params: ligand definition, pdb file, pdb conversion
returns: .mol file for the ligand
\end{DoxyVerb}
 

Definition at line 209 of file conversion\+\_\+pdb\+\_\+mol.\+py.


\begin{DoxyCode}
209     \textcolor{keyword}{def }create\_mol\_file(self, directory, file\_base, mol\_obj, smiles\_file=None):
210         \textcolor{stringliteral}{"""}
211 \textcolor{stringliteral}{        a .mol file is produced for an individual ligand}
212 \textcolor{stringliteral}{}
213 \textcolor{stringliteral}{        params: ligand definition, pdb file, pdb conversion}
214 \textcolor{stringliteral}{        returns: .mol file for the ligand}
215 \textcolor{stringliteral}{        """}
216 
217         out\_file = os.path.join(directory, str(file\_base + \textcolor{stringliteral}{".mol"}))
218 
219         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} mol\_obj:
220             print(f\textcolor{stringliteral}{'WARNING: mol object is empty: \{file\_base\}'})
221 
222         \textcolor{keywordflow}{if} smiles\_file:
223             \textcolor{keywordflow}{try}:
224                 smiles = open(smiles\_file, \textcolor{stringliteral}{'r').readlines()[0].rstrip()}
225 \textcolor{stringliteral}{                template = AllChem.MolFromSmiles(smiles)}
226 \textcolor{stringliteral}{                new\_mol = AllChem.AssignBondOrdersFromTemplate(template, mol\_obj)}
227 \textcolor{stringliteral}{}
228 \textcolor{stringliteral}{                }\textcolor{keywordflow}{return} Chem.rdmolfiles.MolToMolFile(new\_mol, out\_file)
229             \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} e:
230                 print(e)
231                 print(\textcolor{stringliteral}{'failed to fit template '} + smiles\_file)
232                 print(f\textcolor{stringliteral}{'template smiles: \{smiles\}'})
233                 \textcolor{keywordflow}{return} Chem.rdmolfiles.MolToMolFile(mol\_obj, out\_file)
234 
235         \textcolor{keywordflow}{else}:
236             print(f\textcolor{stringliteral}{'Warning: No smiles file: \{file\_base\}'} )
237 
238         \textcolor{comment}{# creating mol file}
239         \textcolor{keywordflow}{return} Chem.rdmolfiles.MolToMolFile(mol\_obj, out\_file)
240 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a1f1e4e6058646f97f6fba517f187b64c}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a1f1e4e6058646f97f6fba517f187b64c}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}!create\+\_\+pdb\+\_\+for\+\_\+ligand@{create\+\_\+pdb\+\_\+for\+\_\+ligand}}
\index{create\+\_\+pdb\+\_\+for\+\_\+ligand@{create\+\_\+pdb\+\_\+for\+\_\+ligand}!fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}}
\subsubsection{\texorpdfstring{create\+\_\+pdb\+\_\+for\+\_\+ligand()}{create\_pdb\_for\_ligand()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand.\+create\+\_\+pdb\+\_\+for\+\_\+ligand (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{ligand,  }\item[{}]{count,  }\item[{}]{monomerize }\end{DoxyParamCaption})}

\begin{DoxyVerb}A pdb file is produced for an individual ligand, containing atomic and connection information

params: vari pdb conversion, ligand definition, list of ligand heteroatoms and information, connection information
returns: .pdb file for ligand
\end{DoxyVerb}
 

Definition at line 82 of file conversion\+\_\+pdb\+\_\+mol.\+py.


\begin{DoxyCode}
82     \textcolor{keyword}{def }create\_pdb\_for\_ligand(self, ligand, count, monomerize):
83         \textcolor{stringliteral}{"""}
84 \textcolor{stringliteral}{        A pdb file is produced for an individual ligand, containing atomic and connection information}
85 \textcolor{stringliteral}{}
86 \textcolor{stringliteral}{        params: vari pdb conversion, ligand definition, list of ligand heteroatoms and information,
       connection information}
87 \textcolor{stringliteral}{        returns: .pdb file for ligand}
88 \textcolor{stringliteral}{        """}
89 
90         \textcolor{comment}{# making ligand name which identifies type of ligand and location, so is specific to the particular
       ligand}
91         ligand\_name = \textcolor{stringliteral}{""}.join(ligand.split())
92 
93         \textcolor{comment}{# out directory and filename for lig pdb}
94         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.target\_name \textcolor{keywordflow}{in} os.path.abspath(self.infile):
95             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} monomerize:
96                 file\_base = str(
97                     self.target\_name
98                     + \textcolor{stringliteral}{"-"}
99                     + os.path.abspath(self.infile)
100                     .split(\textcolor{stringliteral}{"/"})[-1]
101                     .replace(\textcolor{stringliteral}{".pdb"}, \textcolor{stringliteral}{""})
102                     .replace(\textcolor{stringliteral}{"\_bound"}, \textcolor{stringliteral}{""})
103                     + \textcolor{stringliteral}{"\_"}
104                     + str(count)
105                 )
106             \textcolor{keywordflow}{if} monomerize:
107                 file\_base = str(self.target\_name
108                                 + \textcolor{stringliteral}{"-"}
109                                 + os.path.abspath(self.infile)
110                                 .split(\textcolor{stringliteral}{"/"})[-1]
111                                 .replace(\textcolor{stringliteral}{".pdb"}, \textcolor{stringliteral}{""})
112                                 .replace(\textcolor{stringliteral}{"\_bound"}, \textcolor{stringliteral}{""})
113                                 )
114                 chain = file\_base.split(\textcolor{stringliteral}{"\_"})[-1]
115                 file\_base = file\_base[:-2] + \textcolor{stringliteral}{"\_"} + str(count) + chain
116 
117         \textcolor{keywordflow}{else}:
118             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} monomerize:
119                 file\_base = str(
120                                 os.path.abspath(self.infile)
121                                 .split(\textcolor{stringliteral}{"/"})[-1]
122                                 .replace(\textcolor{stringliteral}{".pdb"}, \textcolor{stringliteral}{""})
123                                 .replace(\textcolor{stringliteral}{"\_bound"}, \textcolor{stringliteral}{""})
124                                 + \textcolor{stringliteral}{"\_"}
125                                 + str(count)
126                             )
127             \textcolor{keywordflow}{if} monomerize:
128                 file\_base = str(
129                                 os.path.abspath(self.infile)
130                                 .split(\textcolor{stringliteral}{"/"})[-1]
131                                 .replace(\textcolor{stringliteral}{".pdb"}, \textcolor{stringliteral}{""})
132                                 .replace(\textcolor{stringliteral}{"\_bound"}, \textcolor{stringliteral}{""})
133                             )
134                 chain = file\_base.split(\textcolor{stringliteral}{"\_"})[-1]
135                 file\_base = file\_base[:-2] + \textcolor{stringliteral}{"\_"} + str(count) + chain
136 
137         lig\_out\_dir = os.path.join(self.RESULTS\_DIRECTORY, file\_base)
138 
139         individual\_ligand = []
140         individual\_ligand\_conect = []
141         \textcolor{comment}{# adding atom information for each specific ligand to a list}
142         \textcolor{keywordflow}{for} atom \textcolor{keywordflow}{in} self.final\_hets:
143             \textcolor{keywordflow}{if} str(atom[16:20].strip() + atom[20:26]) == str(ligand):
144                 individual\_ligand.append(atom)
145 
146         con\_num = 0
147         \textcolor{keywordflow}{for} atom \textcolor{keywordflow}{in} individual\_ligand:
148             atom\_number = atom.split()[1]
149             \textcolor{keywordflow}{for} conection \textcolor{keywordflow}{in} self.conects:
150                 \textcolor{keywordflow}{if} (
151                     atom\_number \textcolor{keywordflow}{in} conection
152                     \textcolor{keywordflow}{and} conection \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} individual\_ligand\_conect
153                 ):
154                     individual\_ligand\_conect.append(conection)
155                     con\_num += 1
156 
157         \textcolor{comment}{# checking that the number of conect files and number of atoms are almost the same}
158         \textcolor{comment}{# (taking into account ligands that are covalently bound to the protein}
159 
160         \textcolor{comment}{# assert 0 <= con\_num - len(individual\_ligand) <= 1}
161 
162         \textcolor{comment}{# making into one list that is compatible with conversion to mol object}
163         ligand\_het\_con = individual\_ligand + individual\_ligand\_conect
164 
165         \textcolor{comment}{# make a pdb file for the ligand molecule}
166 
167         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.isdir(lig\_out\_dir):
168             os.makedirs(lig\_out\_dir)
169 
170         ligands\_connections = open(
171             os.path.join(lig\_out\_dir, (file\_base + \textcolor{stringliteral}{".pdb"})), \textcolor{stringliteral}{"w+"}
172         )
173         \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} ligand\_het\_con:
174             ligands\_connections.write(str(line))
175         ligands\_connections.close()
176 
177         \textcolor{comment}{# making pdb file into mol object}
178 
179         pdb\_block = open(os.path.join(lig\_out\_dir, (file\_base + \textcolor{stringliteral}{".pdb"})), \textcolor{stringliteral}{'r').read()}
180 \textcolor{stringliteral}{}
181 \textcolor{stringliteral}{        new\_pdb\_block = ''}
182 
183         \textcolor{keywordflow}{for} lig \textcolor{keywordflow}{in} pdb\_block.split(\textcolor{stringliteral}{'\(\backslash\)n'}):
184             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'ATM'} \textcolor{keywordflow}{in} lig:
185                 pos = 16
186                 s = lig[:pos] + \textcolor{stringliteral}{' '} + lig[pos + 1:]
187                 new\_pdb\_block += s
188             \textcolor{keywordflow}{else}:
189                 new\_pdb\_block += lig
190 
191             new\_pdb\_block += \textcolor{stringliteral}{'\(\backslash\)n'}
192 
193         m = Chem.rdmolfiles.MolFromPDBBlock(new\_pdb\_block)
194 
195         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} m:
196             print(f\textcolor{stringliteral}{'WARNING: \{file\_base\} did not produce a mol object from its pdb lig file!'})
197 
198         \textcolor{keywordflow}{try}:
199             Chem.AddHs(m)
200 
201             self.mol\_lst.append(m)
202             self.mol\_dict[\textcolor{stringliteral}{"directory"}].append(lig\_out\_dir)
203             self.mol\_dict[\textcolor{stringliteral}{"mol"}].append(m)
204             self.mol\_dict[\textcolor{stringliteral}{"file\_base"}].append(file\_base)
205 
206         \textcolor{keywordflow}{except}:
207             print(file\_base, \textcolor{stringliteral}{'is unable to produce a ligand file'})
208 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a9985de5dae739f11768aa6985ccd94bd}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_a9985de5dae739f11768aa6985ccd94bd}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}!create\+\_\+sd\+\_\+file@{create\+\_\+sd\+\_\+file}}
\index{create\+\_\+sd\+\_\+file@{create\+\_\+sd\+\_\+file}!fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}}
\subsubsection{\texorpdfstring{create\+\_\+sd\+\_\+file()}{create\_sd\_file()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand.\+create\+\_\+sd\+\_\+file (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{mol\+\_\+obj,  }\item[{}]{writer }\end{DoxyParamCaption})}

\begin{DoxyVerb}a molecular object defined in the pdb file is used to produce a .sdf file

params: pdb file for the molecule, SDWriter from rdkit
returns: .sdf file with all input molecules from each time the function is called
\end{DoxyVerb}
 

Definition at line 241 of file conversion\+\_\+pdb\+\_\+mol.\+py.


\begin{DoxyCode}
241     \textcolor{keyword}{def }create\_sd\_file(self, mol\_obj, writer):
242         \textcolor{stringliteral}{"""}
243 \textcolor{stringliteral}{        a molecular object defined in the pdb file is used to produce a .sdf file}
244 \textcolor{stringliteral}{}
245 \textcolor{stringliteral}{        params: pdb file for the molecule, SDWriter from rdkit}
246 \textcolor{stringliteral}{        returns: .sdf file with all input molecules from each time the function is called}
247 \textcolor{stringliteral}{        """}
248         \textcolor{comment}{# creating sd file with all mol files}
249         \textcolor{keywordflow}{return} writer.write(mol\_obj)
250 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_aa9601289368daa83655aa849041e7b63}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_aa9601289368daa83655aa849041e7b63}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}!find\+\_\+ligand\+\_\+names\+\_\+new@{find\+\_\+ligand\+\_\+names\+\_\+new}}
\index{find\+\_\+ligand\+\_\+names\+\_\+new@{find\+\_\+ligand\+\_\+names\+\_\+new}!fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}}
\subsubsection{\texorpdfstring{find\+\_\+ligand\+\_\+names\+\_\+new()}{find\_ligand\_names\_new()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand.\+find\+\_\+ligand\+\_\+names\+\_\+new (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Finds list of ligands contained in the structure, including
\end{DoxyVerb}
 

Definition at line 61 of file conversion\+\_\+pdb\+\_\+mol.\+py.


\begin{DoxyCode}
61     \textcolor{keyword}{def }find\_ligand\_names\_new(self):
62         \textcolor{stringliteral}{"""}
63 \textcolor{stringliteral}{        Finds list of ligands contained in the structure, including}
64 \textcolor{stringliteral}{        """}
65         all\_ligands = []  \textcolor{comment}{# all ligands go in here, including solvents and ions}
66         \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} self.pdbfile:
67             \textcolor{keywordflow}{if} line.startswith(\textcolor{stringliteral}{"HETATM"}):
68                 all\_ligands.append(line)
69 
70         \textcolor{keywordflow}{for} lig \textcolor{keywordflow}{in} all\_ligands:
71             \textcolor{keywordflow}{if} (
72                 lig.split()[3][-3:] \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.non\_ligs
73             ):  \textcolor{comment}{# this takes out the solvents and ions a.k.a non-ligands}
74                 self.wanted\_ligs.append(lig[16:20].strip() + lig[20:26])
75                 \textcolor{comment}{# print(lig[16:20].strip() + lig[20:26])}
76 
77         self.wanted\_ligs = list(set(self.wanted\_ligs))
78         \textcolor{comment}{# print(self.wanted\_ligs)}
79 
80         \textcolor{keywordflow}{return} self.wanted\_ligs
81 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_af0d3d0b75f9f10f0f50cba06017c4ba6}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_af0d3d0b75f9f10f0f50cba06017c4ba6}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}!hets\+\_\+and\+\_\+cons@{hets\+\_\+and\+\_\+cons}}
\index{hets\+\_\+and\+\_\+cons@{hets\+\_\+and\+\_\+cons}!fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}}
\subsubsection{\texorpdfstring{hets\+\_\+and\+\_\+cons()}{hets\_and\_cons()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand.\+hets\+\_\+and\+\_\+cons (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Heteroatoms and connect files are pulled out from full pdb file

param: pdb file in .readlines() format
returns: lists of hetatomic information and connection information
\end{DoxyVerb}
 

Definition at line 29 of file conversion\+\_\+pdb\+\_\+mol.\+py.


\begin{DoxyCode}
29     \textcolor{keyword}{def }hets\_and\_cons(self):
30         \textcolor{stringliteral}{"""}
31 \textcolor{stringliteral}{        Heteroatoms and connect files are pulled out from full pdb file}
32 \textcolor{stringliteral}{}
33 \textcolor{stringliteral}{        param: pdb file in .readlines() format}
34 \textcolor{stringliteral}{        returns: lists of hetatomic information and connection information}
35 \textcolor{stringliteral}{        """}
36 
37         \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} self.pdbfile:
38             \textcolor{keywordflow}{if} line.startswith(\textcolor{stringliteral}{"HETATM"}):
39                 self.hetatms.append(line)
40             \textcolor{keywordflow}{if} line.startswith(\textcolor{stringliteral}{"CONECT"}):
41                 self.conects.append(line)
42 
43         \textcolor{keywordflow}{return} self.hetatms, self.conects
44 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_af21865a4bb9be6aab21bfc82668ba25e}\label{classfragalysis__api_1_1xcimporter_1_1conversion__pdb__mol_1_1_ligand_af21865a4bb9be6aab21bfc82668ba25e}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}!remove\+\_\+nonligands@{remove\+\_\+nonligands}}
\index{remove\+\_\+nonligands@{remove\+\_\+nonligands}!fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand@{fragalysis\+\_\+api\+::xcimporter\+::conversion\+\_\+pdb\+\_\+mol\+::\+Ligand}}
\subsubsection{\texorpdfstring{remove\+\_\+nonligands()}{remove\_nonligands()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+conversion\+\_\+pdb\+\_\+mol.\+Ligand.\+remove\+\_\+nonligands (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Non-ligands such as solvents and ions are removed from the list of heteroatoms,
to ideally leave only the target ligand

params: list of heteroatoms and their information, list of non-ligand small molecules
    that could be in crystal structure
returns: list of heteroatoms that are not contained in the non_ligs list
\end{DoxyVerb}
 

Definition at line 45 of file conversion\+\_\+pdb\+\_\+mol.\+py.


\begin{DoxyCode}
45     \textcolor{keyword}{def }remove\_nonligands(self):
46         \textcolor{stringliteral}{"""}
47 \textcolor{stringliteral}{        Non-ligands such as solvents and ions are removed from the list of heteroatoms,}
48 \textcolor{stringliteral}{        to ideally leave only the target ligand}
49 \textcolor{stringliteral}{}
50 \textcolor{stringliteral}{        params: list of heteroatoms and their information, list of non-ligand small molecules}
51 \textcolor{stringliteral}{            that could be in crystal structure}
52 \textcolor{stringliteral}{        returns: list of heteroatoms that are not contained in the non\_ligs list}
53 \textcolor{stringliteral}{        """}
54 
55         \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} self.hetatms:
56             ligand\_name = line[17:20].strip()
57             \textcolor{keywordflow}{if} ligand\_name \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.non\_ligs:
58                 self.final\_hets.append(line)
59         \textcolor{keywordflow}{return} self.final\_hets
60 
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
fragalysis\+\_\+api/xcimporter/conversion\+\_\+pdb\+\_\+mol.\+py\end{DoxyCompactItemize}
