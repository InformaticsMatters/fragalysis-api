\hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize}{}\section{fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize Class Reference}
\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize}\index{fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize@{fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize}}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ab3b407ab1e80bd20413390da2e92bc45}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a20636604f47438298d2420ce35297281}{directory}, \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a7d47cce7a11f51abbfc8b246b42f5181}{outdir})
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ae400c1aa47fa3a5fe32a3ade3f601582}{get\+\_\+filelist} (self)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a95bebe718abd76f9546c67db4a1848b3}{find\+\_\+ligs} (self, pdb\+\_\+lines)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a7dc86cd770a6c7532e96b0f45d91dc2b}{save\+\_\+chain} (self, lig, f)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a182c0cf1af3303f6c13d5160c6c0ff8e}{process\+\_\+ligs} (self, filename)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_aa97d5e71f2d0309e12bc4beafa5151fc}{write\+\_\+bound} (self, inname, outname)
\item 
def \hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a2418993e78b9269ecc5d4222a142261c}{monomerize\+\_\+all} (self)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a20636604f47438298d2420ce35297281}{directory}
\item 
\hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a7d47cce7a11f51abbfc8b246b42f5181}{outdir}
\item 
\hyperlink{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ad165d10ed4bed3d12660094bcd82ea62}{non\+\_\+ligs}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 192 of file align.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ab3b407ab1e80bd20413390da2e92bc45}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ab3b407ab1e80bd20413390da2e92bc45}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{directory,  }\item[{}]{outdir }\end{DoxyParamCaption})}



Definition at line 194 of file align.\+py.


\begin{DoxyCode}
194     \textcolor{keyword}{def }\_\_init\_\_(self, directory, outdir):
195         self.directory = directory
196         self.outdir = outdir
197         self.non\_ligs = json.load(
198             open(os.path.join(os.path.dirname(\_\_file\_\_), \textcolor{stringliteral}{"non\_ligs.json"}), \textcolor{stringliteral}{"r")}
199 \textcolor{stringliteral}{        )}
200 \textcolor{stringliteral}{}
\textcolor{stringliteral}{\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a95bebe718abd76f9546c67db4a1848b3}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a95bebe718abd76f9546c67db4a1848b3}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!find\+\_\+ligs@{find\+\_\+ligs}}
\index{find\+\_\+ligs@{find\+\_\+ligs}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{find\+\_\+ligs()}{find\_ligs()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+find\+\_\+ligs (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{pdb\+\_\+lines }\end{DoxyParamCaption})}

\begin{DoxyVerb}Finds list of ligands contained in the structure, including
\end{DoxyVerb}
 

Definition at line 204 of file align.\+py.


\begin{DoxyCode}
204     \textcolor{keyword}{def }find\_ligs(self, pdb\_lines):
205         \textcolor{stringliteral}{"""}
206 \textcolor{stringliteral}{        Finds list of ligands contained in the structure, including}
207 \textcolor{stringliteral}{        """}
208         all\_ligands = []  \textcolor{comment}{# all ligands go in here, including solvents and ions}
209         wanted\_ligs = []
210         \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} pdb\_lines:
211             \textcolor{keywordflow}{if} line.startswith(\textcolor{stringliteral}{"HETATM"}):
212                 all\_ligands.append(line)
213 
214         \textcolor{keywordflow}{for} lig \textcolor{keywordflow}{in} all\_ligands:
215             \textcolor{keywordflow}{if} (
216                     lig.split()[3][-3:] \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.non\_ligs
217             ):  \textcolor{comment}{# this takes out the solvents and ions a.k.a non-ligands}
218                 wanted\_ligs.append(lig[16:20] + lig[20:26])
219                 \textcolor{comment}{# print(lig[16:20].strip() + lig[20:26])}
220 
221         wanted\_ligs = list(set(wanted\_ligs))
222 
223         \textcolor{keywordflow}{return} wanted\_ligs
224 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ae400c1aa47fa3a5fe32a3ade3f601582}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ae400c1aa47fa3a5fe32a3ade3f601582}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!get\+\_\+filelist@{get\+\_\+filelist}}
\index{get\+\_\+filelist@{get\+\_\+filelist}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{get\+\_\+filelist()}{get\_filelist()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+get\+\_\+filelist (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 201 of file align.\+py.


\begin{DoxyCode}
201     \textcolor{keyword}{def }get\_filelist(self):
202         \textcolor{keywordflow}{return} glob.glob(os.path.join(self.directory, \textcolor{stringliteral}{'*.pdb'}))
203 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a2418993e78b9269ecc5d4222a142261c}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a2418993e78b9269ecc5d4222a142261c}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!monomerize\+\_\+all@{monomerize\+\_\+all}}
\index{monomerize\+\_\+all@{monomerize\+\_\+all}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{monomerize\+\_\+all()}{monomerize\_all()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+monomerize\+\_\+all (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 271 of file align.\+py.


\begin{DoxyCode}
271     \textcolor{keyword}{def }monomerize\_all(self):
272         \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} self.get\_filelist():
273             print(f)
274             outnames = self.process\_ligs(f)
275             print(outnames)
276             self.write\_bound(f, outnames)
277             \textcolor{keywordflow}{for} o \textcolor{keywordflow}{in} outnames:
278                 \textcolor{keywordflow}{if} os.path.isfile(o):
279                     os.remove(o)
280 \end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a182c0cf1af3303f6c13d5160c6c0ff8e}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a182c0cf1af3303f6c13d5160c6c0ff8e}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!process\+\_\+ligs@{process\+\_\+ligs}}
\index{process\+\_\+ligs@{process\+\_\+ligs}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{process\+\_\+ligs()}{process\_ligs()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+process\+\_\+ligs (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{filename }\end{DoxyParamCaption})}



Definition at line 235 of file align.\+py.


\begin{DoxyCode}
235     \textcolor{keyword}{def }process\_ligs(self, filename):
236         test\_block = open(filename, \textcolor{stringliteral}{'r').readlines()}
237 \textcolor{stringliteral}{        ligs = self.find\_ligs(test\_block)}
238 \textcolor{stringliteral}{        print(ligs)}
239 \textcolor{stringliteral}{        outnames = []}
240 \textcolor{stringliteral}{        }\textcolor{keywordflow}{for} lig \textcolor{keywordflow}{in} ligs:
241             o = self.save\_chain(lig, filename)
242             outnames.append(o)
243             \textcolor{keywordflow}{if} os.path.isfile(filename.replace(\textcolor{stringliteral}{'.pdb'}, \textcolor{stringliteral}{'\_smiles.txt'})):
244                 shutil.copy(filename.replace(\textcolor{stringliteral}{'.pdb'}, \textcolor{stringliteral}{'\_smiles.txt'}), o.replace(\textcolor{stringliteral}{'\_mono.pdb'}, \textcolor{stringliteral}{'\_smiles.txt'}))
245         \textcolor{keywordflow}{return} outnames
246 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a7dc86cd770a6c7532e96b0f45d91dc2b}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a7dc86cd770a6c7532e96b0f45d91dc2b}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!save\+\_\+chain@{save\+\_\+chain}}
\index{save\+\_\+chain@{save\+\_\+chain}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{save\+\_\+chain()}{save\_chain()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+save\+\_\+chain (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{lig,  }\item[{}]{f }\end{DoxyParamCaption})}



Definition at line 225 of file align.\+py.


\begin{DoxyCode}
225     \textcolor{keyword}{def }save\_chain(self, lig, f):
226         lig\_chain = lig[5]
227         name = os.path.splitext(os.path.basename(f))[0] + \textcolor{stringliteral}{'\_'} + str(lig\_chain)
228         filename = os.path.join(self.outdir, f\textcolor{stringliteral}{'\{name\}\_mono.pdb'})
229         pymol.cmd.load(f, name)
230         pymol.cmd.save(filename, f\textcolor{stringliteral}{'chain \{lig\_chain\}'})
231         pymol.cmd.reinitialize()
232 
233         \textcolor{keywordflow}{return} filename
234 
\end{DoxyCode}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_aa97d5e71f2d0309e12bc4beafa5151fc}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_aa97d5e71f2d0309e12bc4beafa5151fc}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!write\+\_\+bound@{write\+\_\+bound}}
\index{write\+\_\+bound@{write\+\_\+bound}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{write\+\_\+bound()}{write\_bound()}}
{\footnotesize\ttfamily def fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+write\+\_\+bound (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{inname,  }\item[{}]{outname }\end{DoxyParamCaption})}



Definition at line 247 of file align.\+py.


\begin{DoxyCode}
247     \textcolor{keyword}{def }write\_bound(self, inname, outname):
248         with open(inname, \textcolor{stringliteral}{'r') as handle:}
249 \textcolor{stringliteral}{            switch = 0}
250 \textcolor{stringliteral}{            header\_front, header\_end = [], []}
251 \textcolor{stringliteral}{}
252 \textcolor{stringliteral}{            }\textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} handle:
253 
254                 \textcolor{keywordflow}{if} line.startswith(\textcolor{stringliteral}{'ATOM'}): switch = 1
255 
256                 \textcolor{keywordflow}{if} line.startswith(\textcolor{stringliteral}{'HETATM'}): switch = 2
257 
258                 \textcolor{keywordflow}{if} switch == 0 \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} line.startswith(\textcolor{stringliteral}{'REMARK 350'}): header\_front.append(line)
259 
260                 \textcolor{keywordflow}{if} (switch == 2) \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} line.startswith(\textcolor{stringliteral}{'HETATM'}): header\_end.append(line)
261 
262         \textcolor{keywordflow}{for} o \textcolor{keywordflow}{in} outname:
263             newfile\_contents = open(o, \textcolor{stringliteral}{'r').readlines()}
264 \textcolor{stringliteral}{}
265 \textcolor{stringliteral}{            with open(o.replace('\_mono.pdb'}, \textcolor{stringliteral}{'.pdb'}), \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} handle:
266                 remark = [\textcolor{stringliteral}{'REMARK warning: chains may be ommitted for alignment\(\backslash\)n'}]
267                 new\_pdb = \textcolor{stringliteral}{''}.join(remark + header\_front + newfile\_contents)
268                 print(new\_pdb)
269                 handle.write(new\_pdb)
270 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a20636604f47438298d2420ce35297281}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a20636604f47438298d2420ce35297281}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!directory@{directory}}
\index{directory@{directory}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{directory}{directory}}
{\footnotesize\ttfamily fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+directory}



Definition at line 195 of file align.\+py.

\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ad165d10ed4bed3d12660094bcd82ea62}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_ad165d10ed4bed3d12660094bcd82ea62}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!non\+\_\+ligs@{non\+\_\+ligs}}
\index{non\+\_\+ligs@{non\+\_\+ligs}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{non\+\_\+ligs}{non\_ligs}}
{\footnotesize\ttfamily fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+non\+\_\+ligs}



Definition at line 197 of file align.\+py.

\mbox{\Hypertarget{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a7d47cce7a11f51abbfc8b246b42f5181}\label{classfragalysis__api_1_1xcimporter_1_1align_1_1_monomerize_a7d47cce7a11f51abbfc8b246b42f5181}} 
\index{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}!outdir@{outdir}}
\index{outdir@{outdir}!fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize@{fragalysis\+\_\+api\+::xcimporter\+::align\+::\+Monomerize}}
\subsubsection{\texorpdfstring{outdir}{outdir}}
{\footnotesize\ttfamily fragalysis\+\_\+api.\+xcimporter.\+align.\+Monomerize.\+outdir}



Definition at line 196 of file align.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
fragalysis\+\_\+api/xcimporter/\hyperlink{align_8py}{align.\+py}\end{DoxyCompactItemize}
